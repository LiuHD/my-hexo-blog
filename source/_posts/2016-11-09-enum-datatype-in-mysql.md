---
layout: post
title: 关于mysql中的enum类型
tags: ["mysql","enum"]
date: 2016-11-09 18:00:31
---
> 最近对mysql的enum数据类型很感兴趣，但是也发现一些问题，就是自己设置enum的可选值中有中文时，会出现乱码，甚至在phpmyadmin中设置完enum字段后表结构的页面就打不开了，后来发现其实是字符集的问题，记得一定要设置为utf8_general_ci ，因为归根到底，enum属于字符串类型的数据，需要设置编码的，其他的enum的一些问题在下面这篇文章里有详细介绍。
	
说起这个ENUM，它倒是mysql的一个特色字段，在以前很多人喜欢用它，因为他可以设置字段的区间范围，会让值可以被数据库所控制，不至于出现意料不到的值（比如，字段只想有0和1，结果出现了2，那2就是赃数据了）

但ENUM带来的问题也不少，比如数据迁移的时候，他几乎不可能被其他数据库所支持，如果enum里面是字符串，对于其他数据库来说就更郁闷了，还不能设为tinyint等类型的字段（enum虽然可以存储字符串，但对于内部来说，还是以顺序进行索引，比如'a','b','c'，我们也可以用索引值来获取值select * from tbl_name whre enum = 2，这与select * from tbl_name where enum = 'b'等义）如果你看明白了这两句SQL为什么等义，那么你也就可以了解为什么不主张用enum字段了。

因为，如果一个设计不合理的ENUM字段，给程序员带来的就完全是梦魇了，比如一个enum字段的范围是('0','1','2','3','4','5')，我想这时候，你会不会哭呢？要知道enum的枚举值对应的索引是从1开始的，因此，insert into table (enum)values(1)，你知道是插的什么值吗？你select from table一下，你就会发现，你插入的并不是1，而是0。

更有甚者，由于enum的区间也是可以变动的，如果你在enum的枚举字段范围中加一个值，并且不是加在最后，那么也就相当于，你把原来的范围都改变了索引值，试想这又是多么一个恐怖的事情？

因此，如果你的系统中真的已经使用了mysql的enum字段类型，请在查询的时候直接查询值（并加上单引号），这样就不会使用enum自身隐藏的索引值来获取结果了。【顺便说一下，enum的默认索引是从NULL开始，如果你允许NULL并default NULL】

之所以提起这个，是在用shopnc系统的时候发现大量这样的字段，让人非常郁闷，几乎没有办法优化（如果是纯数值型，还是建议采用tinyint字段吧，毕竟它也只占一个字节，即使出现赃数据，也可以被接受，不象enum，如果纯数字型范围，更改了索引，你就不知道你查询的值是否正确了）

因此建议，如果字段是字符串，并且长度固定，可以尝试用char，如果是数值型，还是用tinyint吧，比较安全稳定，而且即使迁移，问题也不大。
以上转载自[https://my.oschina.net/u/234530/blog/68275](https://my.oschina.net/u/234530/blog/68275)